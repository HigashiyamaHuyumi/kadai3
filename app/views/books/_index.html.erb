<!-- 1ユーザーの本の投稿一覧 -->
<h1>Books</h1>

<table class = "table table-striped">

  <thead>
    <tr>
      <th></th>
      <th>Title</th>
      <th>Opinion</th>
    </tr>
  </thead>

  <tbody>
    <% books.each do |book| %>
      <tr>

        <td>
          <% if book.user.present? && user.present? %> <!--@bookと@userがともに存在 -->
            <% if book.user == current_user %><!-- 自分の投稿の場合 -->
              <% if user.profile_image.attached? %><!-- 画像がある場合 -->
                <%= link_to user_path(current_user) do %>
                  <%= image_tag book.user.profile_image.variant(resize: "100x100") %>
                <% end %>
              <% else %>
                <%= link_to user_path(current_user) do %>
                  <%= image_tag "no_image.jpg", width: 100, height: 100 %>
                <% end %>
              <% end %>

            <% else %> <!-- 他人の投稿の場合 -->
              <% if user.profile_image.attached? %><!-- 画像がある場合 -->
                <%= link_to user_path(book.user) do %>
                  <%= image_tag book.user.profile_image.variant(resize: "100x100") %>
                <% end %>
              <% else %>
                <%= link_to user_path(book.user) do %>
                  <%= image_tag "no_image.jpg", width: 100, height: 100 %>
                <% end %>
              <% end %>

            <% end %>
          <% end %>

        </td>

        <td><%= link_to book.title, book_path(book) %></td>
        <td><%= book.body %></td>
      </tr>
    <% end %>
  </tbody>

</table>

